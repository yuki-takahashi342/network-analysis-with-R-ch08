"0","create_alteralter_data <- function(egonets, netsize, aa_tie_data, "
"0","                                     egoID, max_alter){"
"0","  # Arguments:"
"0","  # egonets: ego network data frame "
"0","  # netsize: vector of ego network size "
"0","  # aa_tie_data : data for each ego showing ties between alters; "
"0","  # assumed to be ordered by 1-2; 1-3; 1-4; 1-5, etc. on the columns"
"0","  # egoID: name of id of ego on ego network data frame"
"0","  # max_alter: maximum of number of alter of which alter-alter tie "
"0","  # data was reported on"
"0",""
"0","  overall_list <- list()"
"0","  "
"0","  # taking out the isolates and those"
"0","  # with only one alter as they have no alter-alter ties "
"0","  egonets_noisolates <- egonets[netsize > 1, ] "
"0","  "
"0","  # also taking out the "
"0","  # isolates and those with only one alter "
"0","  # for the alter-alter tie input data"
"0","  alteralter_tie_data <- aa_tie_data[netsize > 1, ] "
"0",""
"0","  # redefining network size after taking out isolates:"
"0","  netsize_updated <- netsize[netsize > 1] "
"0","  "
"0","  # defining possible alter-alter ties"
"0","  alter_ids <- t(combn(max_alter, 2)) "
"0","  "
"0","  # running over each ego:"
"0","  for (x in 1:nrow(egonets_noisolates)){"
"0","    "
"0","  # First we create a data frame based on the ego ids, the possible "
"0","  # alter-alter ties and the weights for each alter-alter tie, "
"0","  # based on the  input data for that ego"
"0","    alter_dat_row <- data.frame(egoID = egonets_noisolates[x, egoID], "
"0","                                alter_ids, "
"0","                                weight = unlist(alteralter_tie_data[x, ]))"
"0","    "
"0","  # Here we reduce some of the rows (corresponding to alter-alter ties) "
"0","  # if ego had less than the max number of alters or if some "
"0","  # of the alter-alter ties are not present (assumed if value "
"0","  # is equal to 0 or NA)"
"0","    alter_dat_row <- alter_dat_row[alter_dat_row[, 2] <= netsize_updated[x] & "
"0","                              alter_dat_row[, 3] <= netsize_updated[x] & "
"0","                              !is.na(alter_dat_row$weight) & "
"0","                              alter_dat_row$weight != 0, ]"
"0",""
"0","    overall_list[[x]] <- alter_dat_row"
"0","  }"
"0",""
"0","  #putting all alter-alter ties, by ego, in one data frame:"
"0","  alter_alter_dat <- do.call(rbind, overall_list) "
"0",""
"0","  #putting useful column names on the data frame:"
"0","  colnames(alter_alter_dat) <- c(egoID, ""source"", ""target"", ""weight"")"
"0","  rownames(alter_alter_dat) <- 1:nrow(alter_alter_dat)"
"0","  "
"0","  return(alter_alter_dat)"
"0","}"
