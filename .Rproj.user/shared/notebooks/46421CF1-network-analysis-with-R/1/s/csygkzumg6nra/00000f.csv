"0","create_alter_data <- function(egonets, netsize, var_names, egoID){"
"0","  # Arguments: "
"0","  # egonets: ego network data frame"
"0","  # netsize: vector of ego network size"
"0","  # var_names: names of variables to put on alter data frame (assumed to be"
"0","  # var.name1, var.name2, for each alter)"
"0","  # egoID: name of id of ego on ego network data frame"
"0",""
"0","  # creating empty list to hold output for each variable:"
"0","  overall_list <- list() "
"0",""
"0","  # taking out the isolates as they have no alters:"
"0","  egonets_noisolates <- egonets[netsize > 0, ] "
"0","  "
"0","  # redefining network size after taking out isolates:"
"0","  netsize_updated <- netsize[netsize > 0] "
"0",""
"0","  # running over each variable name:"
"0","  for (p in 1:length(var_names)){"
"0","  var_list <- list()"
"0","  alter_list <- list()"
"0","  "
"0","  # running over each ego:"
"0","    for (x in 1:nrow(egonets_noisolates)){"
"0","      # getting alter id number:"
"0","          alter_nums <- rep(1:netsize_updated[x], times = 1)"
"0","      "
"0","      # Now we grab the alter columns for that ego and put those "
"0","      # values in a larger list so we can stack them later on "
"0","      # into one big vector (one for each variable of interest)"
"0","          alt_cols <- paste(rep(var_names[p], each = netsize_updated[x]), "
"0","                            alter_nums, sep = """")"
"0",""
"0","          var_list[[x]] <- egonets_noisolates[x, alt_cols]"
"0","          "
"0","          alter_list[[x]] <- alter_nums"
"0","    }"
"0","  "
"0","  # stacking all alter values into one long column"
"0","  var <- unlist(var_list) "
"0","  overall_list[[p]] <- var"
"0","  } "
"0",""
"0","  # putting all new variables together:"
"0","  dat <- data.frame(do.call(data.frame, overall_list)) "
"0",""
"0","  # putting useful column names on data frame"
"0","  colnames(dat) <- var_names "
"0",""
"0","  # adding egoID and alterID to data frame:"
"0","  dat <- cbind(rep(egonets_noisolates[, egoID], netsize_updated), "
"0","          unlist(alter_list), dat) "
"0",""
"0","  colnames(dat)[1:2] <- c(egoID, ""alterID"")"
"0",""
"0","  return(dat)"
"0","}"
