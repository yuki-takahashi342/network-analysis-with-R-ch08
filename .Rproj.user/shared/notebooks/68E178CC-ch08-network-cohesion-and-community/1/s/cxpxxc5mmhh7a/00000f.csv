"0","proportion_function <- function(communities, attribute){ "
"0","  "
"0","  # 引数:"
"0","  # communities: コミュニティ所属を示すベクトル"
"0","  # attribute: 属性ベクトル"
"0",""
"0","  # ここでは、'attribute' に含まれる各カテゴリに属する割合を計算します。"
"0","  # まず、カテゴリごとの度数表を作成し、次に各カテゴリの割合を求めます。"
"0","  # これは、'communities' を使用して、各コミュニティに対して (tapply を使って) 実行されます。"
"0","  "
"0","  dat <- tapply(factor(attribute), communities, "
"0","              function(x) {y <-  table(x); y / sum(y)})"
"0",""
"0","  # その後、do.call を使用して行列として出力します。"
"0","  return(do.call(rbind, dat))"
"0","}"
